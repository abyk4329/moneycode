<!doctype html>
<html lang="he" dir="rtl">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="theme-color" content="#F6F5F1">
	<title>מחשבון קוד הכסף</title>
	<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
	<meta name="description" content="גלי את קוד הכסף האישי שלך על פי תאריך הלידה – מחשבון נומרולוגי בעברית, חינמי ואלגנטי.">
	<meta name="keywords" content="קוד הכסף, נומרולוגיה, מחשבון נומרולוגי, כסף, שפע, קוד אישי">
	<meta property="og:title" content="מחשבון קוד הכסף">
	<meta property="og:description" content="גלי את קוד הכסף האישי שלך – חישוב נומרולוגי מהיר וקליל בעברית.">
	<meta property="og:image" content="URL_TO_GOLDEN_PREVIEW_IMAGE">
	<meta property="og:type" content="website">
	<meta property="og:locale" content="he_IL">

	<style>
		:root {
			/* New warm palette */
			--desert-rock: #A48D78;      /* חום בז' חמים */
			--soft-sandstone: #CBB9A4;   /* בז' עדין עם נגיעה חמה */
			--creamed-oat: #E6DAC8;      /* שמנת עם נגיעה חולית */
			--porcelain-mist: #F4F1EA;   /* לבן חם-קרמי */
			--feather-white: #FAF9F6;    /* לבן נקי ורך מאוד */
			--light-gold: #E8D2B3;       /* זהב בהיר עדין */
			--warm-gold: #D4A574;        /* זהב חם */
			--deep-brown: #6B5B4F;       /* חום עמוק לטקסט */

			/* Main variables */
			--bg: var(--feather-white);
			--card-bg: var(--porcelain-mist);
			--card-bg-2: var(--creamed-oat);
			--gold: var(--warm-gold);
			--gold-deep: var(--desert-rock);
			--gold-light: var(--light-gold);
			--text: var(--deep-brown);
			--border: var(--soft-sandstone);
			--muted: var(--desert-rock);
			--card-radius: 20px;
			--touch-min: 48px;
		}

		* {
			box-sizing: border-box;
		}

		html, body {
			height: 100%;
		}

		body {
			margin: 0;
			background: var(--bg);
			color: var(--text);
			font-family: 'Assistant', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial;
			-webkit-font-smoothing: antialiased;
			display: flex;
			align-items: center;
			justify-content: center;
			min-height: 100svh;
		}

		main {
			min-height: 100svh;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: calc(20px + env(safe-area-inset-top)) calc(20px + env(safe-area-inset-right)) calc(20px + env(safe-area-inset-bottom)) calc(20px + env(safe-area-inset-left));
		}

		.card {
			position: relative;
			overflow: visible;
			width: 100%;
			max-width: 800px;
			background: linear-gradient(145deg, var(--card-bg), var(--card-bg-2));
			border-radius: var(--card-radius);
			box-shadow: 
				0 15px 35px rgba(164, 141, 120, 0.12), 
				0 5px 15px rgba(164, 141, 120, 0.08),
				inset 0 1px 0 rgba(255, 255, 255, 0.3);
			backdrop-filter: blur(12px);
			-webkit-backdrop-filter: blur(12px);
			padding: 32px;
			border: 1px solid rgba(203, 185, 164, 0.4);
			-webkit-tap-highlight-color: transparent;
			text-align: center;
			animation: cardFloat 6s ease-in-out infinite;
		}

		@keyframes cardFloat {
			0%, 100% { transform: translateY(0px) scale(1); }
			50% { transform: translateY(-3px) scale(1.002); }
		}

		@keyframes shimmer {
			0% { background-position: -200% 0; }
			100% { background-position: 200% 0; }
		}

		@keyframes goldGlow {
			0%, 100% { box-shadow: 0 6px 16px rgba(212, 165, 116, 0.16), 0 2px 4px rgba(212, 165, 116, 0.08); }
			50% { box-shadow: 0 8px 24px rgba(212, 165, 116, 0.24), 0 4px 8px rgba(212, 165, 116, 0.12); }
		}

		.inner {
			display: grid;
			grid-template-columns: 1fr;
			gap: 18px;
		}

		h1 {
			margin: 0;
			font-size: clamp(1.2rem, 3.8vw, 1.6rem);
			text-align: center;
		}

		p.lead {
			margin: 0;
			color: var(--muted);
			text-align: center;
			font-size: clamp(0.95rem, 2.8vw, 1.05rem);
		}

		.field {
			display: flex;
			flex-direction: column;
			gap: 8px;
			align-items: center;
		}

		label {
			font-weight: 700;
			text-align: center;
		}

		input[type=date] {
			appearance: none;
			-webkit-appearance: none;
			padding: 14px 16px;
			border: 2px solid var(--border);
			border-radius: 16px;
			font-size: 1.1rem;
			background: var(--feather-white);
			color: var(--text);
			width: 100%;
			min-height: calc(var(--touch-min));
			transition: all .3s ease;
			box-shadow: inset 0 2px 4px rgba(164, 141, 120, 0.06);
		}

		input[type=date]:focus {
			outline: none;
			border-color: var(--gold);
			box-shadow: 
				inset 0 2px 4px rgba(164, 141, 120, 0.06),
				0 0 0 3px rgba(212, 165, 116, 0.15);
			transform: translateY(-1px);
		}

		.controls {
			display: flex;
			gap: 12px;
			margin-top: 8px;
			justify-content: center;
		}

		button {
			flex: 1;
			padding: 14px;
			border-radius: 12px;
			border: 0;
			font-weight: 700;
			font-size: 1rem;
			cursor: pointer;
			touch-action: manipulation;
			-webkit-tap-highlight-color: transparent;
			min-height: calc(var(--touch-min));
		}

		.btn-primary {
			background: linear-gradient(135deg, var(--gold), var(--gold-deep));
			color: var(--feather-white);
			text-shadow: 0 1px 2px rgba(107, 91, 79, 0.3);
			box-shadow: 0 6px 16px rgba(212, 165, 116, 0.16), 0 2px 4px rgba(212, 165, 116, 0.08);
			transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
			border-radius: 16px;
			padding: 14px 20px;
			letter-spacing: 0.03em;
			position: relative;
			overflow: hidden;
			animation: goldGlow 4s ease-in-out infinite;
		}

		.btn-primary::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.5s ease;
		}

		.btn-primary:hover::before {
			left: 100%;
		}

		.btn-primary:hover,
		.btn-primary:focus {
			background: linear-gradient(135deg, var(--warm-gold), var(--desert-rock));
			outline: 0;
			transform: translateY(-3px) scale(1.02);
			box-shadow: 0 12px 28px rgba(212, 165, 116, 0.24), 0 6px 12px rgba(212, 165, 116, 0.16);
		}

		.btn-ghost {
			background: rgba(244, 241, 234, 0.6);
			border: 2px solid var(--border);
			color: var(--text);
			transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
			border-radius: 16px;
		}

		.btn-ghost:hover,
		.btn-ghost:focus {
			background: var(--gold-light);
			border-color: var(--gold);
			transform: translateY(-2px);
			box-shadow: 0 6px 16px rgba(212, 165, 116, 0.12);
		}

		.result {
			margin-top: 16px;
			padding: 20px;
			border-radius: 18px;
			background: linear-gradient(145deg, rgba(232, 210, 179, 0.15), rgba(244, 241, 234, 0.25));
			border: 2px solid rgba(212, 165, 116, 0.2);
			text-align: center;
			font-weight: 700;
			color: var(--text);
			transition: all .5s cubic-bezier(.2, .9, .2, 1);
			opacity: 0;
			transform: translateY(12px) scale(0.95);
			box-shadow: 
				0 8px 20px rgba(164, 141, 120, 0.1),
				inset 0 1px 0 rgba(255, 255, 255, 0.3);
		}

		.result.visible {
			opacity: 1;
			transform: translateY(0) scale(1);
			animation: resultPulse 0.6s ease-out;
		}

		@keyframes resultPulse {
			0% { transform: scale(0.95); }
			50% { transform: scale(1.05); }
			100% { transform: scale(1); }
		}

		#paylink {
			opacity: 0;
			transform: translateY(8px) scale(0.95);
			transition: all .5s cubic-bezier(.16, .84, .44, 1);
		}

		#paylink.show {
			opacity: 1;
			transform: translateY(0) scale(1);
			animation: payBounce 0.6s ease-out 0.3s;
		}

		@keyframes payBounce {
			0% { transform: translateY(0) scale(1); }
			30% { transform: translateY(-4px) scale(1.02); }
			60% { transform: translateY(-1px) scale(1.01); }
			100% { transform: translateY(0) scale(1); }
		}

		.logo-bottom {
			display: block;
			margin: 28px auto 8px;
			width: clamp(120px, 18vw, 200px);
			height: auto;
			opacity: 0.9;
			transition: all .6s cubic-bezier(.2, 1, .3, 1);
			filter: drop-shadow(0 4px 8px rgba(164, 141, 120, 0.15));
		}

		.logo-bottom:hover {
			transform: translateY(-6px) scale(1.05);
			opacity: 1;
			filter: drop-shadow(0 8px 16px rgba(164, 141, 120, 0.25));
			animation: logoGlow 2s ease-in-out infinite;
		}

		@keyframes logoGlow {
			0%, 100% { filter: drop-shadow(0 8px 16px rgba(164, 141, 120, 0.25)); }
			50% { filter: drop-shadow(0 12px 24px rgba(212, 165, 116, 0.35)); }
		}

		.code-ltr {
			direction: ltr;
			unicode-bidi: -webkit-override;
			letter-spacing: 8px;
			font-family: 'Courier New', Monaco, 'Cascadia Code', monospace;
			color: var(--warm-gold);
			text-shadow: 
				0 2px 4px rgba(212, 165, 116, 0.3),
				0 0 10px rgba(212, 165, 116, 0.2);
			font-size: clamp(1.8rem, 5vw, 2.8rem);
			font-weight: 800;
			background: linear-gradient(45deg, var(--warm-gold), var(--gold-light), var(--warm-gold));
			background-size: 200% 200%;
			background-clip: text;
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			animation: shimmer 3s ease-in-out infinite;
			display: block;
			margin: 12px 0;
			text-align: center;
		}

		.error-banner {
			display: none;
			padding: 16px;
			border-radius: 16px;
			background: linear-gradient(145deg, rgba(164, 141, 120, 0.12), rgba(244, 241, 234, 0.2));
			border: 2px solid rgba(164, 141, 120, 0.25);
			color: var(--text);
			font-weight: 600;
			text-align: center;
			box-shadow: 0 4px 12px rgba(164, 141, 120, 0.1);
		}

		.meta {
			margin-top: 6px;
			color: var(--muted);
			font-size: 0.92rem;
			text-align: center;
		}

		.interpretations {
			margin-top: 12px;
			text-align: right;
		}

		.interpretations h3 {
			margin: 8px 0 6px;
			text-align: center;
		}

		.interpretations dl {
			display: grid;
			grid-template-columns: repeat(1, 1fr);
			gap: 8px;
		}

		.interpretations dt {
			font-weight: 700;
		}

		.interpretations dd {
			margin: 0 0 8px 0;
			color: var(--muted);
		}

		@media (max-width: 520px) {
			.card {
				padding: 20px;
			}
			.controls {
				flex-direction: column;
			}
			button {
				padding: 14px;
			}
		}
	</style>

	<script>
		// Generate favicon
		(function() {
			const svg = `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64' width='64' height='64'>
				<defs>
					<radialGradient id='g' cx='35%' cy='30%' r='80%'>
						<stop offset='0%' stop-color='#96775A'/>
						<stop offset='70%' stop-color='#BC9B8B'/>
						<stop offset='100%' stop-color='#BFC1AC' stop-opacity='0.95'/>
					</radialGradient>
				</defs>
				<circle cx='32' cy='32' r='26' fill='url(#g)' />
			</svg>`;			try {
				const b64 = btoa(svg);
				const link = document.createElement('link');
				link.rel = 'icon';
				link.href = 'data:image/svg+xml;base64,' + b64;
				document.head.appendChild(link);
			} catch(e) {
				const enc = encodeURIComponent(svg).replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29');
				const link = document.createElement('link');
				link.rel = 'icon';
				link.href = 'data:image/svg+xml;utf8,' + enc;
				document.head.appendChild(link);
			}
		})();

		// Add subtle background animation
		(function() {
			const style = document.createElement('style');
			style.textContent = `
				body::before {
					content: '';
					position: fixed;
					top: 0;
					left: 0;
					width: 100%;
					height: 100%;
					background: 
						radial-gradient(circle at 20% 30%, rgba(232, 210, 179, 0.1) 0%, transparent 50%),
						radial-gradient(circle at 80% 70%, rgba(244, 241, 234, 0.1) 0%, transparent 50%),
						radial-gradient(circle at 50% 50%, rgba(212, 165, 116, 0.05) 0%, transparent 50%);
					pointer-events: none;
					z-index: -1;
					animation: backgroundFlow 20s ease-in-out infinite;
				}
				
				@keyframes backgroundFlow {
					0%, 100% { opacity: 1; transform: scale(1) rotate(0deg); }
					50% { opacity: 0.7; transform: scale(1.1) rotate(2deg); }
				}
			`;
			document.head.appendChild(style);
		})();

		// Link manifest for PWA
		(function() {
			const mlink = document.createElement('link');
			mlink.rel = 'manifest';
			mlink.href = 'manifest.json';
			document.head.appendChild(mlink);
		})();
	</script>
</head>
<body>
	<main>
		<section class="card" aria-labelledby="title">
			<div class="inner">
				<h1 id="title">מחשבון קוד הכסף</h1>
				<p class="lead">הכנס/י את תאריך הלידה כדי לחשב את קוד הכסף הנומרולוגי</p>

				<div id="error" class="error-banner" role="alert" aria-live="assertive"></div>

				<div class="field">
					<label for="dob">תאריך לידה</label>
					<input id="dob" type="date" lang="he-IL" aria-label="תאריך לידה" />
				</div>

				<div class="controls">
					<button id="compute" class="btn-primary">חשב/י</button>
					<button id="clear" class="btn-ghost">ניקוי</button>
				</div>

				<div id="output" class="result" role="status" aria-live="polite" style="display:none"></div>
				<div style="margin-top:10px;">
					<a id="paylink" class="btn-primary" href="#" role="button" aria-hidden="true" style="display:block;width:100%;text-decoration:none;opacity:0;transform:translateY(6px)">לקבלת פירוש</a>
				</div>

				<div class="interpretations" id="interpretations" style="display:none">
					<h3>פירושי מספרים (1–9)</h3>
					<dl>
						<dt>1</dt><dd>ראשוניות, מנהיגות, יזמות.</dd>
						<dt>2</dt><dd>שיתוף, רגישות, תמיכה.</dd>
						<dt>3</dt><dd>יצירתיות, תקשורת, שמחה.</dd>
						<dt>4</dt><dd>יסוד, יציבות, עבודה קשה.</dd>
						<dt>5</dt><dd>חופש, שינוי, הרפתקאות.</dd>
						<dt>6</dt><dd>אחריות, בית, שירות.</dd>
						<dt>7</dt><dd>חכמה, פנימיות, רוחניות.</dd>
						<dt>8</dt><dd>שפע, כוח כלכלי, ניצחון.</dd>
						<dt>9</dt><dd>אוניברסליות, סיום, חמלה.</dd>
					</dl>
				</div>

				<div class="meta">השתמש/י בבורר התאריכים של המכשיר או הזן תאריך בפורמט yyyy-mm-dd או dd/mm/yyyy</div>
				<img src="Untitled (2000 x 150 px).png" alt="לוגו" class="logo-bottom" aria-hidden="true">
			</div>
		</section>
	</main>

	<script>
		function sumDigitsOnce(value) {
			const s = String(value).replace(/\D/g, '');
			if (!s) return 0;
			return s.split('').reduce((a, b) => a + Number(b), 0);
		}

		function digitalRoot(n) {
			n = Math.abs(Number(n) || 0);
			while (n > 9) {
				n = String(n).split('').reduce((a, b) => a + Number(b), 0);
			}
			return n;
		}

		const dob = document.getElementById('dob');
		const compute = document.getElementById('compute');
		const clearBtn = document.getElementById('clear');
		const out = document.getElementById('output');
		const err = document.getElementById('error');

		function showError(text) {
			err.textContent = text;
			err.style.display = 'block';
			out.style.display = 'none';
		}

		function clearError() {
			err.textContent = '';
			err.style.display = 'none';
		}

		function showOutput(d, m, y, total) {
			clearError();
			out.innerHTML = `קוד הכסף שלך הוא: <span class="code-ltr">${d} ${m} ${y} ${total}</span>`;
			out.style.display = 'block';
		}

		function parseDateInput(val) {
			if (!val) return null;
			if (dob.valueAsDate instanceof Date && !isNaN(dob.valueAsDate)) {
				const dt = dob.valueAsDate;
				return { day: dt.getDate(), month: dt.getMonth() + 1, year: dt.getFullYear() };
			}
			const iso = /^\s*(\d{4})-(\d{1,2})-(\d{1,2})\s*$/;
			let m = val.match(iso);
			if (m) return { year: Number(m[1]), month: Number(m[2]), day: Number(m[3]) };
			const parts = val.trim().split(/[\/\.\-\s]+/);
			if (parts.length === 3) {
				if (parts[0].length === 4) return { year: Number(parts[0]), month: Number(parts[1]), day: Number(parts[2]) };
				if (parts[2].length === 4) return { day: Number(parts[0]), month: Number(parts[1]), year: Number(parts[2]) };
			}
			const parsed = new Date(val);
			if (!isNaN(parsed)) return { day: parsed.getDate(), month: parsed.getMonth() + 1, year: parsed.getFullYear() };
			return null;
		}

		compute.addEventListener('click', () => {
			clearError();
			out.style.display = 'none';
			const raw = dob.value;
			if (!raw) {
				showError('נא לבחור תאריך לידה.');
				return;
			}

			const parsed = parseDateInput(raw);
			if (!parsed) {
				showError('לא ניתן לקרוא את התאריך. השתמש/י בבורר או הזן/י yyyy-mm-dd או dd/mm/yyyy.');
				return;
			}

			let { day, month, year } = parsed;
			const check = new Date(year, month - 1, day);
			if (check.getFullYear() !== Number(year) || (check.getMonth() + 1) !== Number(month) || check.getDate() !== Number(day)) {
				showError('תאריך לא חוקי. בדוק/י ונסה/י שוב.');
				return;
			}

			const daySum = sumDigitsOnce(day);
			const monthReduced = digitalRoot(sumDigitsOnce(month));
			const yearReduced = digitalRoot(year);
			const total = digitalRoot(daySum + monthReduced + yearReduced);

			showOutput(daySum, monthReduced, yearReduced, total);

			// Show pay button with enhanced animation
			const payBtn = document.getElementById('paylink');
			out.classList.add('visible');
			out.style.display = 'block';
			payBtn.setAttribute('aria-hidden', 'false');
			setTimeout(() => payBtn.classList.add('show'), 200);
		});

		clearBtn.addEventListener('click', () => {
			dob.value = '';
			out.style.display = 'none';
			out.classList.remove('visible');
			const payBtn = document.getElementById('paylink');
			payBtn.classList.remove('show');
			payBtn.setAttribute('aria-hidden', 'true');
			clearError();
			dob.focus();
		});

		dob.addEventListener('keydown', (e) => {
			if (e.key === 'Enter') compute.click();
		});

		// Payment flow
		const paylink = document.getElementById('paylink');
		function buildReturnUrl() {
			return encodeURIComponent(window.location.origin + window.location.pathname + window.location.search);
		}

		paylink.addEventListener('click', (e) => {
			e.preventDefault();
			const href = `pay.html?return=${buildReturnUrl()}&amount=5`;
			window.location.href = href;
		});

		// Show interpretations if paid
		const params = new URLSearchParams(window.location.search);
		if (params.get('paid') === '1') {
			document.getElementById('interpretations').style.display = 'block';
			document.getElementById('interpretations').setAttribute('aria-hidden', 'false');
		}
	</script>

	<script>
		// Register service worker for PWA
		if ('serviceWorker' in navigator) {
			window.addEventListener('load', function() {
				navigator.serviceWorker.register('sw.js').catch(function(err) {
					console.info('SW registration failed:', err);
				});
			});
		}
	</script>
</body>
</html>

